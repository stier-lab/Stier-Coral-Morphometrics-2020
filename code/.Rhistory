p.style = numeric_stars,
digits=5,
dv.labels = c("Field volume vs. abundance","Software volume vs. abundance"))
pl3 <- c(
'(Intercept)' = "Intercept",
volume_field = "elipsoid volume")
pl4 <- c(
'(Intercept)' = "Intercept",
volume_pg = "software est. volume")
tab_model(lm_invert_field,lm_invert_pg,
pred.labels = c(pl3,pl4),
show.se = TRUE,
string.ci = "Conf. Int (95%)",
string.p = "P-Value",
p.style = "numeric_stars",
digits=5,
dv.labels = c("Field volume vs. abundance","Software volume vs. abundance"))
#HTML table comparing volume methods and abundance
pl3 <- c(
'(Intercept)' = "Intercept",
volume_field = "elipsoid volume")
pl4 <- c(
'(Intercept)' = "Intercept",
volume_pg = "software est. volume")
tab_model(lm_invert_field,lm_invert_pg,
pred.labels = c(pl3,pl4),
show.se = TRUE,
string.ci = "Conf. Int (95%)",
string.p = "P-Value",
p.style = "stars",
digits=5,
dv.labels = c("Field volume vs. abundance","Software volume vs. abundance"))
pl3 <- c(
'(Intercept)' = "Intercept",
volume_field = "elipsoid volume")
pl4 <- c(
'(Intercept)' = "Intercept",
volume_pg = "software est. volume")
tab_model(lm_invert_field,lm_invert_pg,
pred.labels = c(pl3,pl4),
show.se = TRUE,
string.ci = "Conf. Int (95%)",
string.p = "P-Value",
digits=5,
dv.labels = c("Field volume vs. abundance","Software volume vs. abundance"))
#HTML table comparing volume methods and richness
pl5 <- c(
'(Intercept)' = "Intercept",
volume_field = "elipsoid volume")
pl6 <- c(
'(Intercept)' = "Intercept",
volume_pg = "software est. volume")
tab_model(lm_richness_field,lm_richness_pg,
pred.labels = c(pl5,pl6),
show.se = TRUE,
string.ci = "Conf. Int (95%)",
string.p = "P-Value",
digits=5,
dv.labels = c("Field volume vs. richness","Software volume vs. richness"))
pl5 <- c(
'(Intercept)' = "Intercept",
volume_field = "Elipsoid volume")
pl6 <- c(
'(Intercept)' = "Intercept",
volume_pg = "Software est. volume")
tab_model(lm_richness_field,lm_richness_pg,
pred.labels = c(pl5,pl6),
show.se = TRUE,
string.ci = "Conf. Int (95%)",
string.p = "P-Value",
digits=5,
dv.labels = c("Field volume vs. richness","Software volume vs. richness"))
glm3 <- glm(num_cafi~volume_pg+sphericity+packing+height+length+width, family=quasipoisson, data=cafi_coral)
glm3 <- glm(num_cafi~volume_pg+sphericity+packing+height_pg+length_pg+width_pg, family=quasipoisson, data=cafi_coral)
summary(glm3)
glm3 <- glm(num_cafi~volume_pg+sphericity+packing+height_pg, family=quasipoisson, data=cafi_coral)
glm3 <- glm(num_cafi~volume_pg+sphericity+packing+height_pg, family=quasipoisson, data=cafi_coral)
summary(glm3)
cor_var <- cafi_coral %>%
dplyr::select(num_cafi,volume_pg,volume_field,SA,avg_w_cm,interstitial_space,sphericity,convexity,packing)
pairs.panels(cor_var,
method="pearson",
hist.col = "white",
density=TRUE,
ellipses=FALSE,
scale=TRUE)
cor_var <- cafi_coral %>%
dplyr::select(num_cafi,volume_pg,height_pg,volume_field,SA,avg_w_cm,interstitial_space,sphericity,convexity,packing)
pairs.panels(cor_var,
method="pearson",
hist.col = "white",
density=TRUE,
ellipses=FALSE,
scale=TRUE)
glm3 <- glm(num_cafi~volume_pg+sphericity+packing+avg_w_cm, family=quasipoisson, data=cafi_coral)
summary(glm3)
glm3 <- glm(num_cafi~volume_pg+sphericity+packing, family=quasipoisson, data=cafi_coral)
glm3 <- glm(num_cafi~volume_pg+sphericity+packing, family=quasipoisson, data=cafi_coral)
summary(glm3)
glm3 <- glm(num_cafi~volume_pg+sphericity+convexity, family=quasipoisson, data=cafi_coral)
summary(glm3)
glm3 <- glm(num_cafi~volume_pg+convexity, family=quasipoisson, data=cafi_coral)
summary(glm3)
glm3 <- glm(num_cafi~volume_pg+packing+sphericity+convexity, family=quasipoisson, data=cafi_coral)
summary(glm3)
glm3 <- glm(num_cafi~volume_pg+packing+sphericity+convexity+avg_w_cm, family=quasipoisson, data=cafi_coral)
summary(glm3)
glm3 <- glm(num_cafi~volume_pg+packing+sphericity+convexity+avg_w_cm+height_pg, family=quasipoisson, data=cafi_coral)
summary(glm3
s
summary(glm3)
glm3 <- glm(num_cafi~volume_pg+packing+sphericity+convexity+avg_w_cm, family=quasipoisson, data=cafi_coral)
summary(glm3)
glm3 <- glm(num_cafi~volume_pg+packing+convexity+avg_w_cm, family=quasipoisson, data=cafi_coral)
summary(glm3)
glm3 <- glm(num_cafi~volume_pg+packing+avg_w_cm, family=quasipoisson, data=cafi_coral)
summary(glm3)
glm3 <- glm(num_cafi~volume_pg+packing, family=quasipoisson, data=cafi_coral)
summary(glm3)
glm3 <- glm(num_cafi~volume_pg+packing, family=quasipoisson, data=cafi_coral)
glm1 <- glm(num_cafi~volume_pg+interstitial_space, family=quasipoisson, data=cafi_coral)
summary(glm1)
glm2 <- glm(num_cafi~volume_field+avg_w_cm, family=quasipoisson, data=cafi_coral)
summary(glm2)
glm1 <- glm(num_cafi~volume_pg+avg_w_cm, family=quasipoisson, data=cafi_coral)
summary(glm1)
glm2 <- glm(num_cafi~volume_pg+branch+sphericity+packing, family=quasipoisson, data=cafi_coral)
summary(glm2)
glm2 <- glm(num_cafi~volume_pg+branch+sphericity+packing+height_pg+convexity, family=quasipoisson, data=cafi_coral)
summary(glm2)
glm2 <- glm(num_cafi~height_pg+packing, family=quasipoisson, data=cafi_coral)
summary(glm2)
glm2 <- glm(num_cafi~height_pg+packing+sphericity, family=quasipoisson, data=cafi_coral)
summary(glm2)
glm2 <- glm(num_cafi~height_pg+packing+sphericity+convexity, family=quasipoisson, data=cafi_coral)
summary(glm2)
glm2 <- glm(num_cafi~volume_pg+height_pg, family=quasipoisson, data=cafi_coral)
summary(glm2)
glm2 <- glm(num_cafi~volume_pg, family=quasipoisson, data=cafi_coral)
summary(glm2)
lm_sphericity <- lm(num_cafi~sphericity, data = cafi_coral)
lm_height <- lm(num_cafi~height_pg, data = cafi_coral)
lm_width <- lm(num_cafi~width_pg, data = cafi_coral)
lm_length <- lm(num_cafi~length_pg, data = cafi_coral)
pl7 <- c(
'(Intercept)' = "Intercept",
volume_pg = "Software est. volume"
)
pl8 <- c(
'(Intercept)' = "Intercept",
sphericity = "Sphericity"
)
pl9 <- c(
'(Intercept)' = "Intercept",
packing = "Packing"
)
tab_model(lm_invert_pg,lm_sphericity, lm_packing,
pred.labels = c(pl7,pl8,pl9),
show.se = TRUE,
string.ci = "Conf. Int (95%)",
string.p = "P-Value",
digits=5,
dv.labels = c("Software est. V","Sphericity","Packing"))
pl7 <- c(
'(Intercept)' = "Intercept",
volume_pg = "Software est. volume"
)
pl8 <- c(
'(Intercept)' = "Intercept",
sphericity = "Sphericity"
)
pl9 <- c(
'(Intercept)' = "Intercept",
packing = "Packing"
)
tab_model(lm_invert_pg,lm_sphericity, lm_packing,
pred.labels = c(pl7,pl8,pl9),
show.se = TRUE,
string.ci = "Conf. Int (95%)",
string.p = "P-Value",
digits=5,
dv.labels = c("Abundance vs. Software volume","Abundance vs. sphericity","Abundance vs. packing"))
pl7 <- c(
'(Intercept)' = "Intercept",
volume_pg = "Software est. volume"
)
pl8 <- c(
'(Intercept)' = "Intercept",
sphericity = "Sphericity"
)
pl9 <- c(
'(Intercept)' = "Intercept",
packing = "Packing"
)
tab_model(lm_invert_pg,lm_sphericity, lm_packing,
pred.labels = c(pl7,pl8,pl9),
show.se = TRUE,
string.ci = "Conf. Int (95%)",
string.p = "P-Value",
digits=5,
dv.labels = c("Abundance vs. software volume","Abundance vs. sphericity","Abundance vs. packing"))
pl10 <- c('(Intercept)' = "Intercept",
height_pg = "Height")
pl11 <- c('(Intercept)' = "Intercept",
length_pg = "Length")
pl12 <- c('(Intercept)' = "Intercept",
width_pg = "Width")
tab_model(lm_height,lm_length, lm_width,
pred.labels = c(pl10,pl11,pl12),
show.se = TRUE,
string.ci = "Conf. Int (95%)",
string.p = "P-Value",
digits=5,
dv.labels = c("Abundance vs. height","Abundance vs. length","Abundance vs. width"))
names(cafi_coral)
lm_sph_rich <- lm(cafi_richness~sphericity, data=cafi_coral)
lm_pack_rich <- lm(cafi_richness~packing, data=cafi_coral)
lm_height_rich <- lm(cafi_richness~height_pg, data=cafi_coral)
lm_length_rich <- lm(cafi_richness~length_pg, data=cafi_coral)
lm_width_pg <- lm(cafi_richness~width_pg, data=cafi_coral)
pl10 <- c('(Intercept)' = "Intercept",
height_pg = "Height")
pl11 <- c('(Intercept)' = "Intercept",
length_pg = "Length")
pl12 <- c('(Intercept)' = "Intercept",
width_pg = "Width")
tab_model(lm_height_rich,lm_length_rich, lm_width_rich,
pred.labels = c(pl10,pl11,pl12),
show.se = TRUE,
string.ci = "Conf. Int (95%)",
string.p = "P-Value",
digits=5,
dv.labels = c("Richness vs. height","Richness vs. length","Richness vs. width"))
lm_width_rich <- lm(cafi_richness~width_pg, data=cafi_coral)
pl10 <- c('(Intercept)' = "Intercept",
height_pg = "Height")
pl11 <- c('(Intercept)' = "Intercept",
length_pg = "Length")
pl12 <- c('(Intercept)' = "Intercept",
width_pg = "Width")
tab_model(lm_height_rich,lm_length_rich, lm_width_rich,
pred.labels = c(pl10,pl11,pl12),
show.se = TRUE,
string.ci = "Conf. Int (95%)",
string.p = "P-Value",
digits=5,
dv.labels = c("Richness vs. height","Richness vs. length","Richness vs. width"))
ggsave("fig4.pdf", plot = fig4, path="figs", width=6, height=4)
glm1 <- glm(num_cafi~height_pg+avg_w_cm+sphericity+packing, family=quasipoisson, data=cafi_coral)
summary(glm1)
glm1 <- glm(num_cafi~height_pg+avg_w_cm+packing, family=quasipoisson, data=cafi_coral)
summary(glm1)
glm1 <- glm(num_cafi~height_pg+avg_w_cm, family=quasipoisson, data=cafi_coral)
summary(glm1)
glm1 <- glm(num_cafi~height_pg+avg_w_cm+branch, family=quasipoisson, data=cafi_coral)
summary(glm1)
glm1 <- glm(num_cafi~height_pg+avg_w_cm+branch+convexity, family=quasipoisson, data=cafi_coral)
summary(glm1)
glm1 <- glm(num_cafi~height_pg+avg_w_cm+convexity, family=quasipoisson, data=cafi_coral)
summary(glm1)
glm1 <- glm(num_cafi~height_pg+avg_w_cm, family=quasipoisson, data=cafi_coral)
summary(glm1)
glm2 <- glm(num_cafi~volume_pg, family=poisson, data=cafi_coral)
summary(glm2)
glm3 <- glm(num_cafi~volume_field, family=poisson, data=cafi_coral)
summary(glm2)
glm2 <- glm(num_cafi~volume_pg, family=poisson, data=cafi_coral)
summary(glm2)
glm3 <- glm(num_cafi~volume_field, family=poisson, data=cafi_coral)
summary(glm2)
glm3 <- glm(num_cafi~volume_field, family=poisson, data=cafi_coral)
summary(glm3)
glm2 <- glm(num_cafi~volume_pg, family=poisson, data=cafi_coral)
summary(glm2)
glm2 <- glm(num_cafi~volume_field, family=poisson, data=cafi_coral)
summary(glm2)
glm3 <- glm(num_cafi~volume_pg, family=poisson, data=cafi_coral)
summary(glm3)
pl_poisson <- c(
'(Intercept)' = "Intercept",
volume_ = "Elipsoid volume")
pl2_poisson <- c(
'(Intercept)' = "Intercept",
volume_pg = "Software est. volume")
tab_model(glm2,glm3,
pred.labels = c(pl_poisson,pl2_poisson),
show.se = TRUE,
string.ci = "Conf. Int (95%)",
string.p = "P-Value",
digits=5,
dv.labels = c("Field volume vs. abundance","Software volume vs. abundance"))
pl_poisson <- c(
'(Intercept)' = "Intercept",
volume_field = "Elipsoid volume")
pl2_poisson <- c(
'(Intercept)' = "Intercept",
volume_pg = "Software est. volume")
tab_model(glm2,glm3,
pred.labels = c(pl_poisson,pl2_poisson),
show.se = TRUE,
string.ci = "Conf. Int (95%)",
string.p = "P-Value",
digits=5,
dv.labels = c("Field volume vs. abundance","Software volume vs. abundance"))
pl3_poisson <- c(
'(Intercept)' = "Intercept",
volume_pg = "Elipsoid volume",
avg_w_cm = "Branch width cm.")
tab_model(glm1,
pred.labels = pl3_poisson,
show.se = TRUE,
string.ci = "Conf. Int (95%)",
string.p = "P-Value",
digits=5,
dv.labels = "Poisson")
glm1_field <- glm(num_cafi~height_field, family=poisson, data=cafi_coral)
view(coral_dim)
view(dim_field)
vuongtest(glm2,glm3)
library(MASS)
vuongtest(glm2,glm3)
vuong(glm2,glm3)
vuong.test(glm2,glm3)
library(devtools)
install.packages("devtools")
install.packages("devtools")
library(devtools)
install_github("qpsy/nonnest2")
pl3_poisson <- c(
'(Intercept)' = "Intercept",
volume_pg = "Elipsoid volume",
avg_w_cm = "Branch width cm.")
tab_model(glm1,
pred.labels = pl3_poisson,
show.se = TRUE,
string.ci = "Conf. Int (95%)",
string.p = "P-Value",
digits=5,
dv.labels = "Poisson")
vuong(glm2,glm3)
install.packages(pscl)
install.packages("pscl")
library(pscl)
vuong(glm2,glm3)
install.packages("nonnest2")
library(nonnest2)
vuongtest(glm2,glm3)
vuongtest(glm1,glm2,glm3)
glm1 <- glm(num_cafi~height_pg+avg_w_cm, family=poisson, data=cafi_coral)
summary(glm1)
glm1 <- glm(num_cafi~volume_pg+height_pg+avg_w_cm, family=poisson, data=cafi_coral)
summary(glm1)
glm1 <- glm(num_cafi~volume_pg+packing+sphericity, family=poisson, data=cafi_coral)
summary(glm1)
glm1 <- glm(num_cafi~volume_pg+packing+sphericity+avg_w_cm+height_pg+interstitial_space, family=poisson, data=cafi_coral)
summary(glm1)
AIC(glm1)
stepAIC(glm1)
glm <- glm(num_cafi~volume_pg+sphericity+height_pg+interstial_space, family=poisson, data=cafi_coral)
glm <- glm(num_cafi~volume_pg+sphericity+height_pg+interstitial_space, family=poisson, data=cafi_coral)
summary(glm)
glm <- glm(num_cafi~volume_pg+sphericity+height_pg+interstitial_space, family=poisson, data=cafi_coral)
summary(glm)
glm2 <- glm(num_cafi~volume_field, family=poisson, data=cafi_coral)
summary(glm2)
glm3 <- glm(num_cafi~volume_pg, family=poisson, data=cafi_coral)
summary(glm3)
glm2 <- glm(num_cafi~volume_field, family=poisson, data=cafi_coral)
summary(glm2)
glm2 <- glm(num_cafi~volume_field, family=quasipoisson, data=cafi_coral)
summary(glm2)
glm3 <- glm(num_cafi~volume_pg, family=quasipoisson, data=cafi_coral)
summary(glm3)
vuongtest(glm2,glm3)
glm <- glm(num_cafi~volume_pg+sphericity+height_pg+interstitial_space, family=quasipoisson, data=cafi_coral)
summary(glm)
glm.nb <- glm.nb(num_cafi~volume_pg+sphericity+height_pg+interstitial_space+packing, data=cafi_coral)
glm.nb <- glm.nb(num_cafi~volume_pg+sphericity+height_pg+interstitial_space+packing, data=cafi_coral)
summary(glm.nb)
glm.nb <- glm.nb(num_cafi~volume_pg, data=cafi_coral)
summary(glm.nb)
glm.nb <- glm.nb(num_cafi~volume_pg+avg_w_cm+sphericity+packing, data=cafi_coral)
summary(glm.nb)
glm1 <- glm(num_cafi~volume_pg+packing+sphericity+avg_w_cm+height_pg, family=quasipoisson, data=cafi_coral)
summary(glm1)
stepAIC(glm1)
glm1 <- glm(num_cafi~volume_pg+packing+sphericity+avg_w_cm+height_pg, family=quasipoisson, data=cafi_coral)
summary(glm1)
QAIC(glm1)
glm.nb2 <- glm.nb(num_cafi~volume_field, data=cafi_coral)
summary(glm.nb2)
glm.nb3 <- glm.nb(num_cafi~volume_pg, data=cafi_coral)
summary(glm.nb3)
pl_nb <- c(
'(Intercept)' = "Intercept",
volume_field = "Elipsoid volume")
pl2_nb <- c(
'(Intercept)' = "Intercept",
volume_pg = "Software est. volume")
tab_model(glm.nb2,glm.nb3,
pred.labels = c(pl_nb,pl2_nb),
show.se = TRUE,
string.ci = "Conf. Int (95%)",
string.p = "P-Value",
digits=5,
dv.labels = c("Negative Binomial"))
vuongtest(glm.nb2,glm.nb3)
glm.nb <- glm.nb(num_cafi~volume_pg+avg_w_cm+sphericity+packing, data=cafi_coral)
summary(glm.nb)
glm.nb <- glm.nb(num_cafi~volume_pg+avg_w_cm+sphericity+packing+height_pg, data=cafi_coral)
summary(glm.nb)
glm.nb <- glm.nb(num_cafi~volume_pg+avg_w_cm+height_pg, data=cafi_coral)
summary(glm.nb)
glm.nb <- glm.nb(num_cafi~avg_w_cm+height_pg, data=cafi_coral)
summary(glm.nb)
poiss_field <- glm(num_cafi~volume_field, data=cafi_coral) #Poisson regression for invert count data using elipsoide volume
summary(poiss_field)
poiss_field <- glm(num_cafi~volume_field, family=poisson, data=cafi_coral) #Poisson regression for invert count data using elipsoide volume
summary(poiss_field)
poiss_pg <- glm(num_cafi~volume_pg, family=poisson, data=cafi_coral) #Poisson regression for invert count data using software est. volume
summary(poiss_pg)
poiss_pg <- glm(num_cafi~volume_pg, family=poisson, data=cafi_coral) #Poisson regression for invert count data using software est. volume
summary(poiss_pg)
glm.nb1 <- glm.nb(num_cafi~volume_field, data=cafi_coral) #negative binomial model for elipsoid volume and abundance to account for overdispersion
summary(glm.nb2)
glm.nb2 <- glm.nb(num_cafi~volume_pg, data=cafi_coral) #negative binomial model for software estimated volume and abundance to account for overdispersion
summary(glm.nb3)
pl_nb <- c(
'(Intercept)' = "Intercept",
volume_field = "Elipsoid volume")
pl2_nb <- c(
'(Intercept)' = "Intercept",
volume_pg = "Software est. volume")
tab_model(glm.nb1,glm.nb2,
pred.labels = c(pl_nb,pl2_nb),
show.se = TRUE,
string.ci = "Conf. Int (95%)",
string.p = "P-Value",
digits=5,
dv.labels = c("Negative Binomial"))
library(nonnest2)
v <- vuongtest(glm.nb2,glm.nb3)
tab_model(v)
tab_model(v,)
v <- vuongtest(glm.nb1,glm.nb2)
tab_model(v)
names(cafi_coral)
poiss_field_r <- glm(cafi_richness~volume_field, family=poisson, data=cafi_coral) #Poisson regression for richness using elipsoide volume
summary(poiss_field_r)
poiss_pg_r <- glm(cafi_richness~volume_pg, family=poisson, data=cafi_coral) #Poisson regression for invert richness using software est. volume
summary(poiss_pg_r)
glm.nb3 <- glm.nb(cafi_richness~volume_field, data=cafi_coral) #negative binomial model for elipsoid volume and richness to account for overdispersion
summary(glm.nb2)
glm.nb4 <- glm.nb(cafi_richness~volume_pg, data=cafi_coral) #negative binomial model for software estimated volume and richness to account for overdispersion
summary(glm.nb3)
pl3_nb <- c(
'(Intercept)' = "Intercept",
volume_field = "Elipsoid volume")
pl4_nb <- c(
'(Intercept)' = "Intercept",
volume_pg = "Software est. volume")
tab_model(glm.nb3,glm.nb4,
pred.labels = c(pl3_nb,pl4_nb),
show.se = TRUE,
string.ci = "Conf. Int (95%)",
string.p = "P-Value",
digits=5,
dv.labels = c("Negative binomial richness"))
vuongtest(glm.nb3,glm.nb4)
glm.nb1 <- glm.nb(num_cafi~volume_field, data=cafi_coral) #negative binomial model for elipsoid volume and abundance to account for overdispersion
summary(glm.nb2)
glm.nb2 <- glm.nb(num_cafi~volume_pg, data=cafi_coral) #negative binomial model for software estimated volume and abundance to account for overdispersion
summary(glm.nb3)
pl_nb <- c(
'(Intercept)' = "Intercept",
volume_field = "Elipsoid volume")
pl2_nb <- c(
'(Intercept)' = "Intercept",
volume_pg = "Software est. volume")
tab_model(glm.nb1,glm.nb2,
pred.labels = c(pl_nb,pl2_nb),
show.se = TRUE,
string.ci = "Conf. Int (95%)",
string.p = "P-Value",
digits=5,
dv.labels = c("Negative binomial abundance"))
library(nonnest2)
vuongtest(glm.nb1,glm.nb2)
knitr::opts_chunk$set(echo = FALSE)
# Load libraries
library(here)
library(dplyr)
library(tidyverse)
library(vegan)
library(reshape)
library(ggplot2)
library(ggpubr)
library(zoo)
library(sjPlot)
library(sjmisc)
library(sjlabelled)
library(psych)
library(knitr)
library(faraway)
library(car)
library(MASS)
library(gridExtra)
library(grid)
library(AER)
#Load data
branch_width <- read.csv(here("photogrammetry_data/branchwidth_data.csv"))
```{r, include=TRUE, include=FALSE}
